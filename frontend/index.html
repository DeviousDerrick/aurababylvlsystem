<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level System | Aurababy</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@800&display=swap" rel="stylesheet" />
    <script src="leaderboard.js"></script>
    <style>
        /* GLOBAL POFFINS BOLD 800 */
        * {
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif !important;
            font-weight: 800 !important;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #ffffff;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        /* STAR BACKGROUND */
        .star {
            position: fixed;
            width: 12px; height: 12px;
            background: white;
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            filter: drop-shadow(0 0 6px white);
            opacity: 0.4;
            z-index: -1;
        }

        /* TOP NAVIGATION AREA */
        .nav-container {
            width: 100%;
            max-width: 800px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .nav-btns { display: flex; gap: 10px; }

        .btn-ui {
            padding: 12px 18px;
            border-radius: 10px;
            text-decoration: none;
            font-size: 0.85rem;
            transition: 0.2s;
            border: none;
            cursor: pointer;
            display: inline-block;
        }

        #achButton { background: #ffdd57; color: black; box-shadow: 0 0 10px #ffdd57; }
        #leaderboardBtn { background: #00ffcc; color: black; box-shadow: 0 0 10px #00ffcc; }
        #timeSpent { background: rgba(0, 0, 0, 0.5); color: white; border: 1px solid rgba(255,255,255,0.2); }

        /* MAIN GLASS CARD */
        .main-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            padding: 40px 20px;
            width: min(95%, 600px);
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
        }

        h1 { 
            font-size: 2rem; 
            margin: 0; 
            color: #d6bcfa; 
            text-shadow: 0 0 15px rgba(214, 188, 250, 0.5);
            text-transform: uppercase;
        }

        .level-display { font-size: 3.5rem; color: #fff; margin: 10px 0; }
        .title-info { font-size: 1rem; color: #ffdd57; margin-bottom: 25px; }

        /* PROGRESS BAR */
        .progress-container {
            width: 100%;
            height: 40px;
            background-color: #1a1a2e;
            border-radius: 20px;
            overflow: hidden;
            border: 2px solid #6b46c1;
            box-shadow: 0 0 15px rgba(107, 70, 193, 0.4);
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #6b46c1, #b794f4);
            transition: width 0.5s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .exp-text, .countdown { margin-top: 10px; font-size: 0.9rem; color: #a0d8ef; }

        /* REDEEM SECTION */
        .redeem-box {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        input[type="text"] {
            padding: 12px;
            border-radius: 8px;
            border: none;
            width: 80%;
            text-align: center;
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
        }

        #redeemBtn {
            background: #6b46c1;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            transition: 0.3s;
            width: 80%;
        }

        #redeemBtn:hover { background: #805ad5; transform: scale(1.02); }

        /* REWARDS LIST */
        .level-rewards {
            margin-top: 40px;
            text-align: left;
            background: rgba(0,0,0,0.2);
            padding: 20px;
            border-radius: 15px;
        }
        .level-rewards h2 { color: #ffdd57; font-size: 1.1rem; text-align: center; margin-top: 0; }
        .level-rewards li { list-style: none; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 0.85rem; }
        .level-rewards a { color: #00ffcc; text-decoration: none; }

        /* POPUPS & OVERLAYS */
        #levelUpPopup {
            position: fixed; top: 20%; left: 50%; transform: translateX(-50%);
            background: #00ff99; color: black; padding: 20px 40px;
            border-radius: 12px; box-shadow: 0 0 20px #00ff99;
            opacity: 0; pointer-events: none; transition: 0.5s; z-index: 10001;
        }

        #qteOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(10, 10, 30, 0.9); z-index: 20000;
            display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        #qteOverlay.active { display: flex; }
        .qte-orb {
            position: absolute; width: 70px; height: 70px; border-radius: 50%;
            background: radial-gradient(circle, #fff, #6b46c1);
            box-shadow: 0 0 25px #6b46c1; cursor: pointer;
        }
    </style>
</head>

<body>
    <div id="qteOverlay">
        <div id="qteMessage" style="font-size: 2.5rem; color: #ff4444; margin-bottom: 10px;">‚ö†Ô∏è AURA SURGE! ‚ö†Ô∏è</div>
        <div style="font-size: 1.2rem; color: white; margin-bottom: 20px;">CLICK THE 3 ORBS FAST!</div>
        <div id="qteTimer" style="font-size: 2rem; color: #ffdd57;">5.0s</div>
    </div>

    <div class="nav-container">
        <div class="nav-btns">
            <a href="achievements.html" id="achButton" class="btn-ui">üèÜ ACHIEVEMENTS</a>
            <a href="leaderboard.html" id="leaderboardBtn" class="btn-ui">üìä LEADERBOARD</a>
        </div>
        <div id="timeSpent" class="btn-ui">TIME: 0m 0s</div>
    </div>

    <main class="main-container">
        <h1>AURABABY LEVELING</h1>
        <div class="level-display"><span id="level">0</span></div>
        <div class="title-info" id="title">üçº TITLE: NONE YET</div>

        <div class="progress-container">
            <div class="progress-bar" id="expBar">0%</div>
        </div>

        <div class="exp-text">EXP: <span id="exp">0</span> / <span id="nextExp">100</span></div>
        <div class="countdown" id="countdown">NEXT EXP IN: 60 SECONDS</div>

        <div class="redeem-box">
            <input type="text" id="codeInput" placeholder="ENTER CODE" />
            <button id="redeemBtn" onclick="redeemCode()">REDEEM CODE</button>
            <div id="codeMessage" style="color:#ffdd57; font-size: 0.8rem; height: 15px;"></div>
        </div>

        <div class="level-rewards">
            <h2>üéÅ LEVEL REWARDS</h2>
            <ul id="rewardList" style="padding:0; margin:0;">
                <li data-level="25">üîí LEVEL 25 REWARD: ???</li>
                <li data-level="50">üîí LEVEL 50 REWARD: ???</li>
                <li data-level="75">üîí LEVEL 75 REWARD: ???</li>
                <li data-level="100">üîí LEVEL 100 REWARD: ???</li>
            </ul>
        </div>
    </main>

    <div id="levelUpPopup">üéâ LEVEL UP! üéâ</div>

    <div class="star" style="top: 10%; left: 15%;"></div>
    <div class="star" style="top: 25%; left: 80%;"></div>
    <div class="star" style="top: 60%; left: 10%;"></div>
    <div class="star" style="top: 85%; left: 70%;"></div>

    <script>
        /* ALL ORIGINAL LOGIC RESTORED */
        let totalSeconds = parseInt(localStorage.getItem("totalSeconds") || "0");
        let displaySec = parseInt(localStorage.getItem("displaySec") || "0");

        function updateDisplayTime() {
            let mins = Math.floor(displaySec / 60);
            let secs = displaySec % 60;
            document.getElementById("timeSpent").innerText = `TIME: ${mins}m ${secs}s`;
        }

        setInterval(() => {
            totalSeconds++;
            displaySec++;
            localStorage.setItem("totalSeconds", totalSeconds);
            localStorage.setItem("displaySec", displaySec);
            updateDisplayTime();
        }, 1000);

        const maxLevel = 100;
        let exp = parseInt(localStorage.getItem("exp") || "0");
        let secondsLeft = parseInt(localStorage.getItem("secondsLeft") || "60");
        let usedCodes = JSON.parse(localStorage.getItem("usedCodes") || "{}");

        // Full Code Lists
        const codes5000 = ["teroswillrebirth","300GamesBaby!","400GamesSoon?"];
        const codes2500 = ["scarebaby","goonerbaby","creeplingbaby","babyiscoming","67","aurababybegoated","aurababywontdie"];
        const codes1000 = ["derrickistuff","danielistuff","mannyistuff","grantistuff","emmetistuff","shout-out-to-adonis"];
        const codesHoliday = ["merrychristmas", "merryhanukkah", "hollyandjolly", "jinglethebells", "sleddingbaby!", "gingerbaby", "santababy!", "jollybaby"]; 
        const validCodes = [...codes5000, ...codes2500, ...codes1000, ...codesHoliday].map(c => c.toLowerCase());

        const titleMap = { 1: "üß¨ Sperm Cell", 5: "üë∂ Newborn", 10: "‚ú®üë∂ Aurababy", 25: "üåæüë∂ Aurafarmer", 50: "üååüë∂ Celestial", 75: "üëº Divine", 100: "üí´ Aura Master" };
        const rewards = { 25: "https://hianime.cx", 50: "https://npm.lat.cdn.cloudflare.net/", 75: "http://xcpugbjyjm.finxstudio.fi/", 100: "https://www.khanacademy.ink/" };

        const BASE_XP_COST = 100;
        const TARGET_MAX_XP = 200000;
        const XP_CURVE_EXPONENT = Math.log(TARGET_MAX_XP / BASE_XP_COST) / Math.log(maxLevel - 1);
        const expTable = [];
        for (let i = 0; i <= maxLevel; i++) {
            if (i <= 1) expTable.push(0);
            else expTable.push(Math.floor(BASE_XP_COST * Math.pow(i - 1, XP_CURVE_EXPONENT)));
        }

        function getLevelFromExp(x) {
            for (let i = 1; i <= maxLevel; i++) if (x < expTable[i]) return i - 1;
            return maxLevel;
        }

        function updateUI() {
            localStorage.setItem("exp", exp);
            const level = getLevelFromExp(exp);
            const nextLevelExp = expTable[level + 1] || expTable[maxLevel];
            const currentLevelExp = expTable[level];

            document.getElementById("level").innerText = level;
            document.getElementById("exp").innerText = exp.toLocaleString();
            document.getElementById("title").innerText = "üçº TITLE: " + (titleMap[level] || "AURABABY");

            if (level >= maxLevel) {
                document.getElementById("expBar").style.width = "100%";
                document.getElementById("expBar").innerText = "MAX LEVEL";
            } else {
                const percent = Math.floor(((exp - currentLevelExp) / (nextLevelExp - currentLevelExp)) * 100);
                document.getElementById("expBar").style.width = percent + "%";
                document.getElementById("expBar").innerText = percent + "%";
                document.getElementById("nextExp").innerText = nextLevelExp.toLocaleString();
            }
            updateRewards(level);
        }

        function updateRewards(level) {
            document.querySelectorAll("#rewardList li").forEach(li => {
                const lvl = parseInt(li.dataset.level);
                if (level >= lvl) {
                    li.innerHTML = `‚úÖ LEVEL ${lvl} REWARD: <a href="${rewards[lvl]}" target="_blank">CLAIM HERE</a>`;
                }
            });
        }

        setInterval(() => {
            if (getLevelFromExp(exp) >= maxLevel) return;
            secondsLeft--;
            document.getElementById("countdown").innerText = `NEXT EXP IN: ${secondsLeft} SECONDS`;
            if (secondsLeft <= 0) {
                exp = Math.min(exp + 20, expTable[maxLevel]);
                updateUI();
                secondsLeft = 60;
                checkLevelUp();
            }
        }, 1000);

        let prevLvl = getLevelFromExp(exp);
        function checkLevelUp() {
            let cur = getLevelFromExp(exp);
            if(cur > prevLvl) {
                const p = document.getElementById("levelUpPopup");
                p.style.opacity = 1;
                setTimeout(() => p.style.opacity = 0, 3000);
                prevLvl = cur;
            }
        }

        window.redeemCode = function() {
            const input = document.getElementById("codeInput");
            const code = input.value.trim().toLowerCase();
            const msg = document.getElementById("codeMessage");
            if (usedCodes[code]) { msg.innerText = "ALREADY USED!"; return; }
            if (!validCodes.includes(code)) { msg.innerText = "INVALID CODE!"; return; }

            let r = 1000;
            if (codes5000.map(c=>c.toLowerCase()).includes(code)) r = 5000;
            else if (codes2500.map(c=>c.toLowerCase()).includes(code)) r = 2500;

            exp = Math.min(exp + r, expTable[maxLevel]);
            usedCodes[code] = true;
            localStorage.setItem("usedCodes", JSON.stringify(usedCodes));
            updateUI();
            msg.innerText = "CODE REDEEMED! +" + r + " EXP";
            input.value = "";
        };

        // Aura Surge Trigger
        setInterval(() => { if(Math.random() > 0.8) triggerSurge(); }, 120000);

        function triggerSurge() {
            const overlay = document.getElementById("qteOverlay");
            overlay.classList.add("active");
            let timeLeft = 5.0;
            let clicked = 0;
            for(let i=0; i<3; i++) {
                let orb = document.createElement("div");
                orb.className = "qte-orb";
                orb.style.top = (20 + Math.random() * 60) + "%";
                orb.style.left = (20 + Math.random() * 60) + "%";
                orb.onclick = () => { orb.remove(); clicked++; if(clicked >= 3) end(true); };
                overlay.appendChild(orb);
            }
            let timer = setInterval(() => {
                timeLeft -= 0.1;
                document.getElementById("qteTimer").innerText = timeLeft.toFixed(1) + "s";
                if(timeLeft <= 0) end(false);
            }, 100);
            function end(s) {
                clearInterval(timer);
                overlay.classList.remove("active");
                document.querySelectorAll(".qte-orb").forEach(o => o.remove());
                if(s) { exp += 500; updateUI(); alert("‚ö° SURGE SUCCESS! +500 EXP"); }
            }
        }

        updateUI();
    </script>
</body>
</html>
